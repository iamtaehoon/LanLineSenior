<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../static/css/edit_style.css" th:href="@{/css/edit_style.css}">
    <title>코멘트 수정</title>
    <script type="text/javascript">
        /*<![CDATA[*/
        let restaurantId = [[${param.restaurantId}]];
        let reviewId = [[${param.reviewId}]];
        /*]]*/

        var xmlHttp = new XMLHttpRequest();

        xmlHttp.onreadystatechange = function () {
            if (this.status === 200 && this.readyState === this.DONE) {
                opener.location.replace(`/restaurants/${restaurantId}`);
                window.close();
            }
        }

        function requestUpdate() {

            console.log(restaurantId+ " : "+reviewId)

            var writerName = document.getElementById("writerName").value;
            var password = document.getElementById("password").value;
            console.log(password);
            var content = document.getElementById("content").value;

            var data = `writerName=${writerName}&password=${password}&content=${content}&restaurantId=${restaurantId}&reviewId=${reviewId}`;

            xmlHttp.open("PATCH", "/reviews");
            xmlHttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xmlHttp.send(data);

            console.log(window.opener);

        }
    </script>
</head>
<body>
<h3>댓글 수정</h3>
<div>
    <input type="text" th:id="writerName" th:name="writerName" th:value="${review.writerName}">
    <input id="password" type="password">
    <input type="text" th:id="content" th:name="content" th:value="${review.content}">
    <button onclick="requestUpdate()">수정</button>
</div>
</body>
</html>